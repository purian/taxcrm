<div class="container mt-5" dir="rtl">
  <h1 class="mb-4 text-right">עידכון מספרי טלפון</h1>

  <div class="card">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-bordered table-hover mb-0 text-right">
          <thead>
            <tr class="bg-light">
              <th class="px-4 py-3">תעודת זהות</th>
              <th class="px-4 py-3">שם</th>
              <th class="px-4 py-3">טלפון</th>
              <th class="px-4 py-3">הערה</th>
              <th class="px-4 py-3">פעולות</th>
            </tr>
          </thead>
          <tbody>
            <% @leads.each_with_index do |lead, index| %>
              <tr>
                <td class="px-4 py-3">
                  <% if lead.Email.present? || lead.Address.present? %>
                    <span data-toggle="tooltip" data-placement="top" 
                          title="<%= [lead.Email, lead.Address].compact.join(' | ') %>"
                          id="company-<%= index %>">
                      <%= lead.CompanyId %>
                      <i class="fas fa-info-circle ml-1"></i>
                    </span>
                  <% else %>
                    <%= lead.CompanyId %>
                  <% end %>
                </td>
                <td class="px-4 py-3">
                  <% if lead.Email.present? || lead.Address.present? %>
                    <span data-toggle="tooltip" data-placement="top" 
                          title="<%= [lead.Email, lead.Address].compact.join(' | ') %>"
                          id="name-<%= index %>">
                      <%= lead.Name %>
                    </span>
                  <% else %>
                    <%= lead.Name %>
                  <% end %>
                </td>
               <%= form_with(model: ExternalDetail.new, url: external_data_path, method: :post, local: true, class: 'form-inline') do |f| %>
  <%= f.hidden_field :object_id, value: lead.objectId %>
  <td class="px-4 py-3">
    <%= f.text_field :phone_number, class: 'form-control form-control-sm' %>
  </td>
  <td class="px-4 py-3">
    <%= f.text_area :comment, class: 'form-control form-control-sm', rows: 1 %>
  </td>
  <td class="px-4 py-3">
    <div class="d-flex justify-content-between" style="gap: 10px;">
      <%= f.submit 'שמור', class: 'btn btn-primary btn-sm flex-grow-1' %>
    </div>
  </td>
<% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-center mt-4">
    
  </div>
</div>

<script>
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
</script>